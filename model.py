import numpy as np
from keras.models import load_model, model_from_json

model = load_model('trained_model.h5')
# with open('model_digit.json') as f:
#     model1 = model_from_json(f.read())
# model.load_weights('model_digit.h5')


def recognize(array):

    x_input = []
    for i in range(28):
        dim2 = []
        for j in range(28):
            dim2.append([0])
        x_input.append(dim2)

    for item in array:
        # print(item)
        x_input[item[0]][item[1]] = [item[2]]

    x_input = np.array([x_input]).astype('float32')
    # print(x_input.shape)
    # print(x_input)
    output = model.predict(x_input)[0].tolist()
    return output.index(max(output))


x_test = [[5,6,0.05],[5,7,0.47],[5,8,0.79],[5,9,0.97],[5,10,1],[5,11,0.97],[5,12,0.84],[5,13,0.54],[5,14,0.07],[6,6,0.69],[6,7,1],[6,8,1],[6,9,1],[6,10,1],[6,11,1],[6,12,1],[6,13,1],[6,14,0.83],[6,15,0.04],[7,6,0.64],[7,7,1],[7,8,0.82],[7,9,0.54],[7,10,0.5],[7,11,0.55],[7,12,0.78],[7,13,1],[7,14,1],[7,15,0.43],[8,6,0.02],[8,7,0.14],[8,12,0.01],[8,13,0.87],[8,14,1],[8,15,0.68],[9,13,0.7],[9,14,1],[9,15,0.77],[10,13,0.64],[10,14,1],[10,15,0.8],[11,13,0.87],[11,14,1],[11,15,0.7],[12,12,0.22],[12,13,1],[12,14,1],[12,15,0.44],[13,12,0.7],[13,13,1],[13,14,0.96],[13,15,0.08],[13,23,0.25],[13,24,0.55],[13,25,0.1],[14,11,0.19],[14,12,1],[14,13,1],[14,14,0.56],[14,23,0.91],[14,24,1],[14,25,0.58],[15,11,0.62],[15,12,1],[15,13,0.98],[15,14,0.12],[15,22,0.18],[15,23,1],[15,24,1],[15,25,0.41],[16,11,0.88],[16,12,1],[16,13,0.65],[16,21,0.05],[16,22,0.73],[16,23,1],[16,24,1],[16,25,0.14],[17,11,0.89],[17,12,1],[17,13,0.96],[17,14,0.82],[17,15,0.8],[17,16,0.7],[17,17,0.7],[17,18,0.7],[17,19,0.74],[17,20,0.85],[17,21,0.99],[17,22,1],[17,23,1],[17,24,0.66],[18,11,0.53],[18,12,1],[18,13,1],[18,14,1],[18,15,1],[18,16,1],[18,17,1],[18,18,1],[18,19,1],[18,20,1],[18,21,1],[18,22,1],[18,23,0.73],[18,24,0.06],[19,12,0.27],[19,13,0.58],[19,14,0.66],[19,15,0.7],[19,16,0.79],[19,17,0.8],[19,18,0.8],[19,19,0.77],[19,20,0.66],[19,21,0.5],[19,22,0.27]]
assert recognize(x_test) == 2
